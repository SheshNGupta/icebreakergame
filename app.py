
from flask import Flask, render_template
from flask_socketio import SocketIO, emit
import time
import threading

app = Flask(__name__)
socketio = SocketIO(app, cors_allowed_origins="*")

# In-memory storage for scores and players
players = {}
current_question = None
time_started = None
question_index = 0
game_started = False

game_questions = [
    {"question": "What is the capital of France?", "options": ["Berlin", "Madrid", "Paris", "Rome"], "answer": "Paris","image":"https://media.timeout.com/images/106181719/image.jpg"},
    {"question": "Which planet is known as the Red Planet?", "options": ["Venus", "Mars", "Jupiter", "Saturn"], "answer": "Mars","image":"data:image/jpeg;base64,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"},
    #{"question": "What is the largest ocean on Earth?", "options": ["Atlantic Ocean", "Indian Ocean", "Arctic Ocean", "Pacific Ocean"], "answer": "Pacific Ocean"},
    #{"question": "Who wrote 'Hamlet'?", "options": ["Charles Dickens", "William Shakespeare", "Mark Twain", "Jane Austen"], "answer": "William Shakespeare"},
    #{"question": "What is the chemical symbol for gold?", "options": ["Ag", "Au", "Pb", "Fe"], "answer": "Au"},
    #{"question": "How many continents are there on Earth?", "options": ["5", "6", "7", "8"], "answer": "7"},
    #{"question": "What is the fastest land animal?", "options": ["Cheetah", "Lion", "Horse", "Gazelle"], "answer": "Cheetah"},
    #{"question": "Which gas do plants absorb during photosynthesis?", "options": ["Oxygen", "Carbon Dioxide", "Hydrogen", "Nitrogen"], "answer": "Carbon Dioxide"},
    #{"question": "Who painted the Mona Lisa?", "options": ["Michelangelo", "Vincent van Gogh", "Leonardo da Vinci", "Pablo Picasso"], "answer": "Leonardo da Vinci"},
    {"question": "What is the square root of 64?", "options": ["6", "7", "8", "9"], "answer": "8","image":"data:image/jpeg;base64,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"}
]

def start_new_question():
    global current_question, time_started, question_index
    if question_index < len(game_questions):
        current_question = game_questions[question_index]
        time_started = time.time()
        socketio.emit("new_question", current_question)
        threading.Timer(40, show_scores).start()  # Show scores after 60 sec

    else:
        #socketio.emit("game_over", {"message": "Game Over!"})
        handle_game_over()  # Call game over function

def show_scores():
    global question_index
    socketio.emit("show_scores", players)
    question_index += 1
    if (question_index==len(game_questions)):
        handle_game_over()
    else:
        threading.Timer(10, start_new_question).start()  # Show scores for 30 sec

@app.route('/')
def index():
    return render_template("index.html")

@socketio.on("join")
def handle_join(data):
    username = data["username"]
    if username not in players:
        players[username] = 0
        print(username+" has joined!")  # Debugging output
    if len(players) == 1:
        emit("assign_host",{"username": username},broadcast=True)
    emit("player_joined", {"players": list(players.keys())}, broadcast=True)

@socketio.on("start_game")
def handle_start_game():
    global game_started
    if not game_started:
        game_started = True
        print("Game has started!")  # Debugging output
        start_new_question()

@socketio.on("answer")
def handle_answer(data):
    global time_started
    username = data["username"]
    answer = data["answer"]
    elapsed_time = time.time() - time_started
    score = max(100 - int(elapsed_time), 60)  # Min 40 points for answering

    if answer == current_question["answer"]:
        players[username] += score
    emit("update_scores", players, broadcast=True)

@socketio.on("game_over")
def handle_game_over():
    if players:
        # Determine the winner (highest score)
        winner = max(players, key=players.get)
        final_scores = {"scores": players, "winner": winner}
    else:
        final_scores = {"scores": {}, "winner": "No players"}

    # Emit game over event with the winner's name
    socketio.emit("game_over", final_scores)

if __name__ == '__main__':
    socketio.run(app, host = '0.0.0.0',debug=True)
